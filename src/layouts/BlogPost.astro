---
import MainLayout from './MainLayout.astro';
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, pubDate, updatedDate, image, author } = post.data;

const formattedPubDate = new Date(pubDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const formattedUpdatedDate = updatedDate
  ? new Date(updatedDate).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    })
  : null;

// Icons
const calendarIcon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
  <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
</svg>`;

const authorIcon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
</svg>`;
---

<MainLayout title={title} description={description} image={image}>
  <article class="max-w-4xl mx-auto px-4 py-12">
    {
      image && (
        <div class="mb-10 aspect-video rounded-xl overflow-hidden">
          <img src={image} alt={title} class="w-full h-full object-cover" />
        </div>
      )
    }

    <header class="mb-12 text-center">
      <h1 class="text-4xl font-bold text-secondary-900 dark:text-white mb-6">{title}</h1>
      <div
        class="flex items-center justify-center gap-6 text-sm text-secondary-600 dark:text-secondary-400"
      >
        <div class="flex items-center gap-2">
          <span set:html={authorIcon} />
          <span>{author}</span>
        </div>
        <div class="flex items-center gap-2">
          <span set:html={calendarIcon} />
          <time datetime={pubDate.toISOString()}>{formattedPubDate}</time>
          {
            formattedUpdatedDate && updatedDate && (
              <span class="text-xs">
                (Updated:{' '}
                <time datetime={new Date(updatedDate).toISOString()}>{formattedUpdatedDate}</time>)
              </span>
            )
          }
        </div>
      </div>
    </header>

    <div
      class="prose prose-lg dark:prose-invert mx-auto prose-headings:text-secondary-900 dark:prose-headings:text-white prose-a:text-primary-600 dark:prose-a:text-primary-400 prose-img:rounded-xl"
    >
      <slot />
    </div>
  </article>
</MainLayout>
